<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MonarchR Basics • monarchr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MonarchR Basics">
<meta property="og:description" content="monarchr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">monarchr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Basics.html">MonarchR Basics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Basics_files/kePrint-0.0.1/kePrint.js"></script><link href="Basics_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MonarchR Basics</h1>
                        <h4 data-toc-skip class="author">Shawn T
O’Neil</h4>
            
            <h4 data-toc-skip class="date">2024-02-17</h4>
      
      
      <div class="hidden name"><code>Basics.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>The MonarchR package is designed to support interactive queries
against the <a href="https://monarchinitiative.org" class="external-link">Monarch
Initiative</a> Knowledge Graph (KG). It is in early development and
testing, and relies upon publicly-available services managed by the
Monarch Initiative.</p>
<p>Briefly, a graph stored in a local variable represents a subsets of
nodes and/or edges from the larger KG. These local graphs are also <a href="https://tidygraph.data-imaginist.com/" class="external-link"><code>tidygraph</code></a>
objects (which are <a href="https://r.igraph.org/" class="external-link">igraph</a>s)
providing a large range of graph-related functionality.</p>
<p>First, let’s load some useful libraries:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">monarchr</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span> <span class="co"># for kbl() table output formatting</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'tidygraph'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'kableExtra'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group_rows</span></span></code></pre>
<p>The <code><a href="../reference/monarch_search.html">monarch_search()</a></code> function uses the keyword search <a href="https://api-v3.monarchinitiative.org/v3/docs" class="external-link">API</a>, returning
up to <code>limit</code> nodes, and no edges connecting them:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/monarch_search.html">monarch_search</a></span><span class="op">(</span><span class="st">"Ehlers-danlos syndrome"</span>, limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tbl_graph: 5 nodes and 0 edges</span></span></span>
<span><span class="co"><span style="color: #949494;">## #</span></span></span>
<span><span class="co"><span style="color: #949494;">## # A rooted forest with 5 trees</span></span></span>
<span><span class="co"><span style="color: #949494;">## #</span></span></span>
<span><span class="co"><span style="color: #949494;">## # Node Data: 5 × 8 (active)</span></span></span>
<span><span class="co">##   id            category   pcategory iri   synonym name  description provided_by</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;named li&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;named&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;named lis&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> MONDO:0007525 <span style="color: #949494;">&lt;chr [6]&gt;</span>  biolink:… http… <span style="color: #949494;">&lt;chr&gt;</span>   Ehle… Arthrochal… <span style="color: #949494;">&lt;chr [1]&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> MONDO:0012873 <span style="color: #949494;">&lt;chr [6]&gt;</span>  biolink:… http… <span style="color: #949494;">&lt;chr&gt;</span>   Ehle… Ehlers-Dan… <span style="color: #949494;">&lt;chr [1]&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> MONDO:0007522 <span style="color: #949494;">&lt;chr [6]&gt;</span>  biolink:… http… <span style="color: #949494;">&lt;chr&gt;</span>   Ehle… Ehlers-Dan… <span style="color: #949494;">&lt;chr [1]&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> MONDO:0020066 <span style="color: #949494;">&lt;chr [6]&gt;</span>  biolink:… http… <span style="color: #949494;">&lt;chr&gt;</span>   Ehle… The Ehlers… <span style="color: #949494;">&lt;chr [1]&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> MONDO:0034021 <span style="color: #949494;">&lt;chr [6]&gt;</span>  biolink:… http… <span style="color: #949494;">&lt;chr&gt;</span>   spon… <span style="color: #BB0000;">NA</span>          <span style="color: #949494;">&lt;chr [1]&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #949494;">#</span></span></span>
<span><span class="co"><span style="color: #949494;">## # Edge Data: 0 × 2</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 variables: from &lt;int&gt;, to &lt;int&gt;</span></span></span></code></pre>
<p>Tidygraphs are stored as node and edge dataframes; we can “activate”
one or the other to manipulate it, or extract it with
<code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble()</a></code>. Let’s add a <code>source</code> to these nodes
of <code>"search"</code>, and print the node table. We leave off the
<code>iri</code> to save a little space.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"search"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">iri</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
pcategory
</th>
<th style="text-align:left;">
synonym
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
description
</th>
<th style="text-align:left;">
provided_by
</th>
<th style="text-align:left;">
source
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MONDO:0007525
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
AEDS , EDS 7A , EDS 7B , EDS VII , EDS VII, mutant procollagen type ,
EDS7A (formerly) , EDSARTH1 , Ehlers-Danlos syndrome type 7 ,
Ehlers-Danlos syndrome type 7A (formerly) , Ehlers-Danlos syndrome,
arthrochalasia type , Ehlers-Danlos syndrome, arthrochalasia type, 1 ,
Ehlers-Danlos syndrome, type VII , Ehlers-Danlos syndrome, type VII,
autosomal dominant , Ehlers-Danlos syndrome, type VIIA, autosomal
dominant, arthrochalasia EDS , arthrochalasia Ehlers-Danlos syndrome ,
arthrochalasis multiplex congenita
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome, arthrochalasis type
</td>
<td style="text-align:left;">
Arthrochalasia Ehlers-Danlos syndrome (aEDS) is an inherited connective
tissue disorder that is caused by defects in a protein called collagen.
Common symptoms include severe joint hypermobility ; congenital hip
dislocation; fragile, hyperextensible skin; hypotonia ; and
kyphoscoliosis (kyphosis and scoliosis). EDS, arthrochalasia type is
caused by changes (mutations) in the COL1A1 gene or the COL1A2 gene and
is inherited in an autosomal dominant manner. Treatment and management
is focused on preventing serious complications and relieving associated
signs and symptoms.
</td>
<td style="text-align:left;">
phenio_nodes
</td>
<td style="text-align:left;">
search
</td>
</tr>
<tr>
<td style="text-align:left;">
MONDO:0012873
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
EDS, spondylocheirodysplastic type , EDSSPD3 , Ehlers-Danlos syndrome,
spondylodysplastic type, 3 , SCD-EDS , spondylocheirodysplasia,
Ehlers-Danlos syndrome-like
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome, spondylocheirodysplastic type
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome, spondylocheirodysplastic type is a subtype of
Ehlers-Danlos syndrome characterized by skeletal dysplasia comprising
platyspondyly with moderate short stature, osteopenia and widened
metaphyses, in addition to hyperextensible, thin, easily bruised skin,
hypermobility of small joints with tendency to contractures, prominent
eyes with bluish sclerae, wrinkled palms, atrophy of the thenar muscle
and tapering fingers.
</td>
<td style="text-align:left;">
phenio_nodes
</td>
<td style="text-align:left;">
search
</td>
</tr>
<tr>
<td style="text-align:left;">
MONDO:0007522
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
EDS I , EDS I, formerly , EDS II , EDS II, formerly , EDS, classic type
, Ehlers Danlos syndrome, mild classic type , Ehlers Danlos syndrome,
mild classic type, formerly , Ehlers Danlos syndrome, mitis type ,
Ehlers Danlos syndrome, mitis type, formerly , Ehlers-Danlos syndrome
classic type , Ehlers-Danlos syndrome classical type , Ehlers-Danlos
syndrome type 1 (formerly) , Ehlers-Danlos syndrome type 2 ,
Ehlers-Danlos syndrome type 2 (formerly) , Ehlers-Danlos syndrome,
classic type , Ehlers-Danlos syndrome, gravis type , Ehlers-Danlos
syndrome, gravis type, formerly , Ehlers-Danlos syndrome, severe classic
type , Ehlers-Danlos syndrome, severe classic type, formerly,
Ehlers-Danlos syndrome, type I , Ehlers-Danlos syndrome, type I,
formerly , Ehlers-Danlos syndrome, type II , Ehlers-Danlos syndrome,
type II, formerly , classic Ehlers-Danlos syndrome , classical
Ehlers-Danlos syndrome
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome, classic type
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome, classic type (cEDS) is a form of Ehlers-Danlos
syndrome that affects the connective tissue and is characterized by skin
hyperextensibility, widened atrophic scars and joint hypermobility.
</td>
<td style="text-align:left;">
phenio_nodes
</td>
<td style="text-align:left;">
search
</td>
</tr>
<tr>
<td style="text-align:left;">
MONDO:0020066
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
Danlos Disease, Ehlers , Danlos disease , Disease, Ehlers Danlos ,
Disease, Ehlers-Danlos , Dystrophia mesodermalis congenita , ED syndrome
, EDS , Ehler Danlos Syndrome , Ehlers Danlos Disease , Ehlers Danlos
syndrome , Ehlers-Danlos Disease , Ehlers-Danlos syndromes ,
Fibrodysplasia elastica generalisata, Hereditary collagen dysplasia ,
Meekeren-Ehlers-Danlos syndrome , Syndrome, Ehlers-Danlos , danlos
ehlers syndrome , elastic skin , skin elastic
</td>
<td style="text-align:left;">
Ehlers-Danlos syndrome
</td>
<td style="text-align:left;">
The Ehlers–Danlos syndromes (EDS) are a clinically and genetically
heterogeneous group of heritable connective tissue disorders (HCTDs)
characterized by joint hypermobility, skin hyperextensibility, and
tissue fragility.
</td>
<td style="text-align:left;">
phenio_nodes
</td>
<td style="text-align:left;">
search
</td>
</tr>
<tr>
<td style="text-align:left;">
MONDO:0034021
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
spondylodysplastic EDS
</td>
<td style="text-align:left;">
spondylodysplastic Ehlers-Danlos syndrome
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
phenio_nodes
</td>
<td style="text-align:left;">
search
</td>
</tr>
</tbody>
</table>
<p>The <code>pcategory</code> column is a unique addition of MonarchR:
typically, nodes are annotated with multiple categories, which is stored
in the <code>category</code> field in the KG. These tend to relate to
ontological concepts, in that a <code>biolink:Disease</code> is also a
<code>biolink:BiologicalEntity</code> and
<code>biolink:NamedThing</code>, but in typical use we are interested in
a “primary” category. Rather than try and determine the primary category
of interest from the data, we set a priority list of categories to use,
choosing the first available prioritized category, or the first category
available as a fallback. This can be configured via the
<code>kg_prefs</code> option should you so choose:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"kg_prefs"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $kg_prefs</span></span>
<span><span class="co">## $kg_prefs$monarch_kg</span></span>
<span><span class="co">## $kg_prefs$monarch_kg$category_priority</span></span>
<span><span class="co">##  [1] "biolink:Disease"           "biolink:PhenotypicFeature"</span></span>
<span><span class="co">##  [3] "biolink:Gene"              "biolink:AnatomicalEntity" </span></span>
<span><span class="co">##  [5] "biolink:BiologicalProcess" "biolink:Pathway"          </span></span>
<span><span class="co">##  [7] "biolink:Cell"              "biolink:CellularComponent"</span></span>
<span><span class="co">##  [9] "biolink:ChemicalEntity"    "biolink:Drug"</span></span></code></pre>
<p>Let’s see what kinds of connections exist in the broader graph for
these nodes, which is a good idea before we go and fetch some of them.
We can summarize the nodes in the surrounding neighborhood, or the
edges:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/summarize_neighborhood.html">summarize_neighborhood</a></span><span class="op">(</span><span class="va">g</span>, summarize <span class="op">=</span> <span class="st">"nodes"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
pcategory
</th>
<th style="text-align:right;">
count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
biolink:PhenotypicFeature
</td>
<td style="text-align:right;">
265
</td>
</tr>
<tr>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:right;">
34
</td>
</tr>
<tr>
<td style="text-align:left;">
biolink:Gene
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_neighborhood.html">summarize_neighborhood</a></span><span class="op">(</span><span class="va">g</span>, summarize <span class="op">=</span> <span class="st">"edges"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
count
</th>
<th style="text-align:left;">
query_pcategory
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
result_pcategory
</th>
<th style="text-align:left;">
query_category
</th>
<th style="text-align:left;">
result_category
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
263
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:has_phenotype
</td>
<td style="text-align:left;">
biolink:PhenotypicFeature
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:DiseaseOrPhenotypicFeature,
biolink:Entity , biolink:NamedThing , biolink:PhenotypicFeature ,
biolink:ThingWithTaxon
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:subclass_of
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:gene_associated_with_condition
</td>
<td style="text-align:left;">
biolink:Gene
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:ChemicalEntityOrGeneOrGeneProduct,
biolink:Entity , biolink:Gene , biolink:GeneOrGeneProduct ,
biolink:GenomicEntity , biolink:MacromolecularMachineMixin ,
biolink:NamedThing , biolink:OntologyClass , biolink:PhysicalEssence ,
biolink:PhysicalEssenceOrOccurrent , biolink:ThingWithTaxon
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:causes
</td>
<td style="text-align:left;">
biolink:Gene
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:ChemicalEntityOrGeneOrGeneProduct,
biolink:Entity , biolink:Gene , biolink:GeneOrGeneProduct ,
biolink:GenomicEntity , biolink:MacromolecularMachineMixin ,
biolink:NamedThing , biolink:OntologyClass , biolink:PhysicalEssence ,
biolink:PhysicalEssenceOrOccurrent , biolink:ThingWithTaxon
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
biolink:Disease
</td>
<td style="text-align:left;">
biolink:has_mode_of_inheritance
</td>
<td style="text-align:left;">
biolink:PhenotypicFeature
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:Disease ,
biolink:DiseaseOrPhenotypicFeature, biolink:Entity , biolink:NamedThing
, biolink:ThingWithTaxon
</td>
<td style="text-align:left;">
biolink:BiologicalEntity , biolink:DiseaseOrPhenotypicFeature,
biolink:Entity , biolink:NamedThing , biolink:PhenotypicFeature ,
biolink:ThingWithTaxon
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subtypes</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"in"</span>, predicates <span class="op">=</span> <span class="st">"biolink:subclass_of"</span>, transitive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">with_phenos</span> <span class="op">&lt;-</span> <span class="va">subtypes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>predicates <span class="op">=</span> <span class="st">"biolink:has_phenotype"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print(with_phenos)</span></span>
<span>    </span>
<span><span class="va">with_genes</span> <span class="op">&lt;-</span> <span class="va">subtypes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>result_categories <span class="op">=</span> <span class="st">"biolink:Gene"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print(with_genes)</span></span>
<span></span>
<span><span class="va">neighbors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/graph_join.html" class="external-link">graph_join</a></span><span class="op">(</span><span class="va">with_phenos</span>, <span class="va">with_genes</span><span class="op">)</span></span>
<span><span class="va">neighbors</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">neighbors</span> <span class="op">&lt;-</span> <span class="va">neighbors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">neighbors</span>, layout <span class="op">=</span> <span class="st">'fr'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html" class="external-link">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">pcategory</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">eds_phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/monarch_search.html">monarch_search</a></span><span class="op">(</span><span class="st">"Ehlers-danlos syndrome"</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>predicates <span class="op">=</span> <span class="st">"biolink:subclass_of"</span>, direction <span class="op">=</span> <span class="st">"in"</span>, transitive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>result_categories <span class="op">=</span> <span class="st">"biolink:PhenotypicFeature"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># eds_phenos</span></span>
<span></span>
<span><span class="va">fanconi_phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/monarch_search.html">monarch_search</a></span><span class="op">(</span><span class="st">"Fanconi anemia"</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>predicates <span class="op">=</span> <span class="st">"biolink:subclass_of"</span>, direction <span class="op">=</span> <span class="st">"in"</span>, transitive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/fetch_edges.html">fetch_edges</a></span><span class="op">(</span>result_categories <span class="op">=</span> <span class="st">"biolink:PhenotypicFeature"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fanconi_phenos</span></span>
<span></span>
<span><span class="va">inner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">eds_phenos</span>, <span class="va">nodes</span><span class="op">)</span>, <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">fanconi_phenos</span>, <span class="va">nodes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">inner</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">inner</span>, layout <span class="op">=</span> <span class="st">'fr'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html" class="external-link">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">pcategory</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/graph_join.html" class="external-link">graph_join</a></span><span class="op">(</span><span class="va">eds_phenos</span>, <span class="va">fanconi_phenos</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">both</span>, layout <span class="op">=</span> <span class="st">'fr'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html" class="external-link">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">pcategory</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
