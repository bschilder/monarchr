## ----setup, include=FALSE, message=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
library(dplyr)
library(tidygraph)
library(monarchr)

options(width = 300)
knitr::opts_chunk$set(eval = TRUE, echo = TRUE)

wrap <- function(labels, size = 20) {
	wrapped <- labels %>% lapply(strwrap, size)
	reformatted <- wrapped %>% lapply(paste, collapse = "\n")
	return(as.character(reformatted))
}

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
nodes_kbl

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
edges_kbl

## ----welcome, fig.width=10, warning=FALSE, message=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# MONDO:0001982 Niemann-Pick Disease (13 subtypes)

g <- monarch_engine() |>
  fetch_nodes(query_ids = c("MONDO:0001982")) |>
	expand(predicates = "biolink:subclass_of", direction = "in", transitive = TRUE) |>
	expand(result_categories = "biolink:Gene")

plot(g)
g

## ----monarch_engine---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
monarch <- monarch_engine()

## ----neo4j_engine-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# neodb <- neo4j_engine("http://localhost:7687", username = "user", password = "pass")

## ----file_engine_demo-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
filename <- system.file("extdata", "mondo_kgx_tsv.tar.gz", package = "monarchr")
# filename <- "https://kghub.io/kg-obo/mondo/2024-03-04/mondo_kgx_tsv.tar.gz"

print(filename)

mondo <- file_engine(filename)

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
nodes_kbl

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
edges_kbl

## ----fetch_nodes1-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
g <- monarch |>
	fetch_nodes(query_ids = c("MONDO:0009061", "HGNC:1884"))

g

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
nodes_kbl

## ----eval=TRUE, echo=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
edges_kbl

## ----fetch_by_taxon---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
h_sapiens_nodes <- monarch |>
	fetch_nodes(in_taxon_label == "Homo sapiens", limit = 20)
h_sapiens_nodes

